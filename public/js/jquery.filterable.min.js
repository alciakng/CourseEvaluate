/**
 * filterable
 * jQuery plugin that filters an HTML table based on column-specific values using x-editable
 *
 * @author Daniel White
 * @copyright Daniel White 2013
 * @license MIT <https://github.com/lightswitch05/filterable/blob/master/MIT-LICENSE>
 * @link http://lightswitch05.github.io/filterable
 * @module filterable
 * @version 0.1.3
 */
(function(e){e.fn.filterable=function(t){var n={ignoreColumns:[],onlyColumns:null,prependWild:!0,appendWild:!0,ignoreCase:!0};t=e.extend(n,t);var r=function(e){return e!==undefined&&e!==null?!0:!1},i=function(t){e(t).addClass("filterable-match"),e(t).removeClass("filterable-no-match")},s=function(t){e(t).addClass("filterable-no-match"),e(t).removeClass("filterable-match")},o=function(e){e=e.replace(/[\-\[\]\/\{\}\(\)\+\?\.\\\^\$\|]/g,"\\$&"),e=e.replace(/\*/,".*"),e=t.prependWild?".*"+e:e,e+=t.appendWild?".*":e;var n=t.ignoreCase?"i":"";return new RegExp(e,n)},u=function(e,t){return e.test(t)===!0},a=function(t){return e(t).find("td.filterable-no-match").length===0},f=function(t){e(t).addClass("filterable-active")},l=function(t){e(t).removeClass("filterable-active")},c=function(t,n){var r=n.closest("table"),c=n.data("name"),h=o(t);t===""?l(n):f(n),r.children("tbody,*").children("tr").each(function(t,n){if(t!==0){var r=e(n).children("td").eq(c),o=e.trim(r.text());u(h,o)?(i(r),a(n)&&i(n)):(s(r),s(n))}})},h=function(t){e(t).editable({send:"never",type:"text",emptytext:"",display:function(){e(this).text("")}})},p=function(e){e.on("save",function(t,n){c(n.newValue,e)})},d=function(t,n){var r="Enter filter for "+e.trim(t.text()),i=' <i class="icon-filter filterable" data-name="'+n+'" title="'+r+'"></i>';return i=t.append(i).find("i.icon-filter"),h(i),i},v=function(n){return r(t.onlyColumns)?e.inArray(n,t.onlyColumns)===-1:e.inArray(n,t.ignoreColumns)!==-1},m=function(t){var n=t.find("tr:first").first(),r={};return e(n).children("td,th").each(function(t,n){v(t)||(r[t]=e(n))}),r};e(this).each(function(){var t=m(e(this));e.each(t,function(e,t){var n=d(t,e);p(n)})})}})(jQuery);